<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>General Scenarios Using SQL</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 1200px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body></style></head><body><article id="115c4f4e-6826-80f8-bd5a-e7259061b921" class="page sans"><header><h1 class="page-title"><strong>The Story Behind The Data</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="116c4f4e-6826-800b-a1cf-ec43360aede7" class="">
</p><p id="115c4f4e-6826-807c-b4e8-d0a3baeae6ef" class="">
</p><table id="115c4f4e-6826-8058-9402-fd1ab5140869" class="simple-table">
    <tbody>
        <tr id="115c4f4e-6826-800e-93cf-da2e3d324f2b">
            <td id="KXCr" style="width:160px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">Home</a></strong></td>
            <td id="rt" style="width:147px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/AboutMe.html">About</a></strong></td>
            <td id="n" style="width:167px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">Portfolio</a></strong></td>
            <td id="yZ" style="width:181px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/DataVisGall.html">Data Visualization</a></strong></td>
            <td id="FuWk" style="width:144px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">Contact</a></strong></td>
            <td id="cOr" style="width:226px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/scenariomain.html">Scenarios / Problem-solving</a></strong></td>
	   <td id="cOr" style="width:226px"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/certificates.html">Certificates</a></strong></td>
        </tr>
    </tbody>
</table>

</style></head><body><article id="121c4f4e-6826-806a-99a8-da7a8296c731" class="page sans"><header><h1 class="page-title"></h1><p class="page-description"></p></header><div class="page-body"><h3 id="139c4f4e-6826-80fa-add9-f694f061d7e7" class=""><strong>General Scenarios Using SQL</strong></h3><p id="146c4f4e-6826-80d3-9765-f1b99df75aef" class="">
</p><div id="146c4f4e-6826-803c-9d35-c7ed1e5f9137" class="column-list"><div id="146c4f4e-6826-80ab-a473-ee50f64a4970" style="width:195.83333333333331%" class="column"><p id="146c4f4e-6826-80c1-b145-d8c8d7bef2fb" class="">
</p><details close=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Problem Statement: COUNT (Intermediate)</summary><div class="indented"><p id="121c4f4e-6826-806f-a975-ff1f18f5f9b6" class=""><div class="indented"><blockquote id="8c541db5-6851-4f4a-ab62-2ca7271a32b0" class="">Scenario 1:<p id="b798ef5b-9f17-47c8-a2cd-e848ebadb045" class="">--Write a query to count the total number of orders placed by each customer from the orders table, grouped by customer ID.</p><p id="e997f6b6-6898-4bf7-bfbc-42e674c08024" class="">
</p></blockquote></div></p><p id="121c4f4e-6826-80f0-a53b-c3afe1ed2a0e" class="">
</p><p id="121c4f4e-6826-8008-9c69-d0b4bc46282b" class=""><strong>A. Thought Process / Approach:</strong></p><p id="121c4f4e-6826-8041-8f00-c66301f5bb0b" class=""><div class="indented"><ul id="5f25d02f-209e-4065-abca-f32d79ff29fa" class="bulleted-list"><li style="list-style-type:disc">I am focusing on the total number of orders, but I also need to identify the customer through a unique value. I use the customer ID. </li></ul><ul id="121c4f4e-6826-8076-8eb3-dc4dce3bd5b5" class="bulleted-list"><li style="list-style-type:disc">After using the COUNT statement on <mark class="highlight-red"><mark class="highlight-gray_background">order_id</mark></mark> I  gave it an alias to identify the results as Total_orders</li></ul><ul id="888db813-a063-47a9-8788-e85542e481a7" class="bulleted-list"><li style="list-style-type:disc">Grouping by <mark class="highlight-red"><mark class="highlight-gray_background">customer_id</mark></mark> is just to give the result some structure. Ordering by <mark class="highlight-red"><mark class="highlight-gray_background">Total_orders</mark></mark> in descending order will give the customer with the highest number of orders first.</li></ul></div></p><p id="121c4f4e-6826-808c-8ed6-e221b160c66e" class="">
</p><p id="121c4f4e-6826-80de-8a8c-fb87359e652f" class=""><strong>B. Query Code:</strong></p><p id="121c4f4e-6826-80cd-b7e4-ca3ab44916ac" class=""><div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d65b8db7-30c8-403c-b405-d0b59483b6a2" class="code"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- COUNT INTERMEDIATE QUERY
SELECT
    customer_id,
    COUNT(order_id) AS Total_orders
FROM dataset.table_orders
GROUP BY customer_id
ORDER BY Total_orders DESC;

</code></pre></div></p><p id="121c4f4e-6826-80e4-84e2-dbce76315e26" class="">
</p><p id="121c4f4e-6826-80db-8f19-eae9d32a47a5" class=""><strong>C. Explanation of the Result:</strong></p><p id="121c4f4e-6826-800b-8232-c8ca9fd04717" class="">The result will be two columns with the unique customer_id number and total order with the highest order number first.</p><table id="121c4f4e-6826-80ad-a3a3-e7ceb6cd74ee" class="simple-table"><tbody><tr id="121c4f4e-6826-8084-88af-e5adc27bb596"><td id="}FiJ" class="">customer_id</td><td id="jzug" class="">Total_orders</td></tr><tr id="121c4f4e-6826-801f-8a30-d60561a648de"><td id="}FiJ" class="">1</td><td id="jzug" class="">15</td></tr><tr id="121c4f4e-6826-8044-9ec9-e411b492a601"><td id="}FiJ" class="">2</td><td id="jzug" class="">10</td></tr><tr id="121c4f4e-6826-8076-be65-df40f10ac265"><td id="}FiJ" class="">3</td><td id="jzug" class="">5</td></tr></tbody></table></div></details><p id="146c4f4e-6826-805d-8a99-cb7587d5ad39" class="">
</p><details close=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Problem Statement: COUNT (Advance)</summary><div class="indented"><p id="121c4f4e-6826-8001-8263-de132ef796c3" class=""><div class="indented"><blockquote id="ded58f7b-daa6-4486-b8e5-17ba1f1b2b39" class="">Scenario 1:<p id="121c4f4e-6826-803e-a5c0-d062f45aa9b6" class="">Write a query to count the number of distinct customers who made purchases in the year 2022 from a sales table, ensuring that only customers who made more than 3 purchases are included in the results.</p><p id="5c10c604-bd3e-4a0d-9c13-42207914fc4e" class="">
</p></blockquote></div></p><p id="121c4f4e-6826-80bf-82b5-ea9d28984f34" class="">
</p><p id="121c4f4e-6826-80d7-9b10-e0f6ea77f330" class=""><strong>A. Thought Process / Approach:</strong></p><p id="121c4f4e-6826-80a5-bb4c-f2ee15c0279b" class=""><div class="indented"><ul id="b7d5b0ce-ef12-4803-8cb9-20c1b3b53572" class="bulleted-list"><li style="list-style-type:disc">I am focusing on getting the customers who made more than three purchases in 2022. I decided to get the unique customer_id. I want to identify them as 2022_customers so I give the output this name to identify these customers. </li></ul><ul id="7a622bd6-a013-40e2-a23c-d92ca5638759" class="bulleted-list"><li style="list-style-type:disc">Counting the order_id will give the information I need to know which customer made more than 3 purchases. </li></ul><ul id="121c4f4e-6826-8063-9b03-d42a6c07d3e1" class="bulleted-list"><li style="list-style-type:disc">Sometimes the date of purchase is entered 3/1/2022. I only need to know the year so I extract the year from the date. This will narrow my filter to only focus on the year.</li></ul><ul id="121c4f4e-6826-802f-88c7-d7743262bc0b" class="bulleted-list"><li style="list-style-type:disc">I already counted the customer total orders. Now I need to know which one had more than three. I see customer 1 had 2, customer 2 and 3, customer 3 and 4.</li></ul><ul id="121c4f4e-6826-8051-9962-da96b77b4c8d" class="bulleted-list"><li style="list-style-type:disc">Customer 1 should not be in my result. I need to go a step further and there is a statement the <mark class="highlight-red"><mark class="highlight-gray_background">HAVING</mark></mark> that will allow me to get results from aggregated data.</li></ul><p id="121c4f4e-6826-8080-9e88-f584b166dc03" class="">
</p></div></p><p id="121c4f4e-6826-804f-ae52-db02f5dd8f4d" class=""><strong>B. Query Code:</strong></p><p id="121c4f4e-6826-803b-af0e-ecf5c6fa59fb" class=""><div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="40c06768-933d-41a8-94a7-25df62a2cc19" class="code"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- COUNT ADVANCE QUERY

SELECT 
    customer_id, 
    COUNT(order_id) AS Total_orders
FROM 
    dataset.table_sales
WHERE 
    EXTRACT(YEAR FROM purchase_date) = 2022
GROUP BY 
    customer_id
HAVING 
    COUNT(order_id) &gt; 3;

</code></pre></div></p><p id="121c4f4e-6826-80aa-a330-e8f195046dea" class="">
</p><p id="121c4f4e-6826-8013-8683-c98355e6ba7b" class=""><strong>C. Explanation of the Result:</strong></p><p id="121c4f4e-6826-8082-b98a-cdf688d597bf" class="">The result will be two columns with the unique customer_id number and total order with the highest order number first. Example </p><ul id="121c4f4e-6826-8033-a6a9-e21b3182eb88" class="bulleted-list"><li style="list-style-type:disc"><strong>customer_id 101</strong> made 5 purchases.</li></ul><ul id="121c4f4e-6826-80c6-b52f-d953886ce5f8" class="bulleted-list"><li style="list-style-type:disc"><strong>customer_id 203</strong> made 7 purchases.</li></ul><ul id="121c4f4e-6826-80c0-bcfe-ccb8c29804ac" class="bulleted-list"><li style="list-style-type:disc"><strong>customer_id 305</strong> made 4 purchases.</li></ul></div></details><p id="146c4f4e-6826-809d-96ba-e19f9bc02542" class="">
</p><details close=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Using Calculations SUM()</summary><div class="indented"><blockquote id="126c4f4e-6826-8090-b08e-eedb6bc7981f" class="">Question: </blockquote><blockquote id="126c4f4e-6826-80bc-9462-fbaa55cbeaa3" class=""><strong>Write a query that calculates the percentage of all houses completed in the Midwest region compared to the total number of houses completed in the United States from the year 2010 and later. Additionally, return the total number of houses completed in the Midwest region along with the total number of houses completed across all regions.</strong></blockquote><p id="126c4f4e-6826-8051-b509-c34c426ca290" class="">
</p><p id="126c4f4e-6826-80f1-b2f1-f7dacf9068d3" class=""><strong>A. Thought Process / Approach:</strong></p><p id="126c4f4e-6826-80d3-b1d9-ee44dc0cb621" class=""><div class="indented"><h3 id="126c4f4e-6826-8017-81de-f74990e4d4b7" class="">Breakdown:</h3><p id="126c4f4e-6826-80bd-963f-ffeebe35e524" class="">This scenario asks for step-by-step calculation</p><ul id="126c4f4e-6826-80c9-ab47-d7df94e3283f" class="bulleted-list"><li style="list-style-type:disc">I need to sum the total number of houses completed in the <strong>Midwest</strong> region.</li></ul><ul id="126c4f4e-6826-8073-9b94-edf050fbe4ad" class="bulleted-list"><li style="list-style-type:disc">You need to sum the total number of houses completed in <strong>all regions</strong>.</li></ul><ul id="126c4f4e-6826-804b-93a9-c18b126574a9" class="bulleted-list"><li style="list-style-type:disc">Calculate the percentage of houses completed in the <strong>Midwest</strong> compared to the total.</li></ul><ul id="126c4f4e-6826-80ea-a648-d768017ffad1" class="bulleted-list"><li style="list-style-type:disc">Only include results from the year <strong>2010 and later</strong>.</li></ul></div></p><p id="126c4f4e-6826-80dd-888b-d66a5f102abe" class=""><strong>B. Query Code:</strong></p><p id="126c4f4e-6826-8037-a0fd-f9384d390f74" class=""><div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="64248a2d-bc0a-4391-afbf-dc1a9dd8f7f4" class="code"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
SELECT
    year,
    SUM(midwest) AS midwest_houses_total,
    SUM(west + midwest + northeast + north) AS united_states_total,
    (SUM(midwest) / NULLIF(SUM(west + midwest + northeast + north), 0) * 100) AS midwest_housing_percentage
FROM dataset.table_name
WHERE year &gt;= 2010
GROUP BY year;

</code></pre></div></p><p id="126c4f4e-6826-8065-80ba-ff64e9a1684b" class="">
</p><p id="126c4f4e-6826-8002-a77f-fafbc9451356" class=""><strong>C. Explanation of the Result:</strong></p><p id="126c4f4e-6826-8003-93d3-f695ab885ade" class="">When you run the query the expected output should look like this.</p><table id="126c4f4e-6826-8086-b303-dfbf88a57c07" class="simple-table"><tbody><tr id="126c4f4e-6826-80cf-92c1-e9c12eb15a3a"><td id="O;YC" class="" style="width:81px">year</td><td id="BaoS" class="">midwest_houses_total</td><td id="]qzv" class="">united_states_total</td><td id="\JNt" class="">midwest_housing_percentage</td><td id="[iUr" class=""></td></tr><tr id="126c4f4e-6826-802c-89f7-da896098478e"><td id="O;YC" class="" style="width:81px">2010</td><td id="BaoS" class="">25,000</td><td id="]qzv" class="">100,000</td><td id="\JNt" class="">25.00</td><td id="[iUr" class=""></td></tr></tbody></table></div></details><p id="146c4f4e-6826-8098-a577-c294a69bb6bb" class="">
</p><details close=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><strong>Problem Statement: COUNT (Basic)</strong></summary><div class="indented"><p id="146c4f4e-6826-80c9-bcd2-cbe113c34538" class=""><div class="indented"><blockquote id="5bdaf631-6a63-47ff-8880-807b0e8cc84d" class="">Scenario 1:<p id="f387ef90-3d4f-40ef-b388-c292edb5010e" class="">Write a query to count the total number of products in a products table.</p><p id="23052dd2-a3d6-43d2-a79f-327797360479" class="">
</p></blockquote></div></p><p id="146c4f4e-6826-8060-9f32-d638b8b3785a" class="">
</p><p id="146c4f4e-6826-801f-9511-dc9240efafe9" class=""><strong>A. Thought Process / Approach:</strong></p><p id="146c4f4e-6826-80b7-989f-d0bf9b142053" class=""><div class="indented"><ul id="35c8da33-245c-43d5-99da-d102998e9971" class="bulleted-list"><li style="list-style-type:disc">I am focusing on the total number of products, which is why I only need one column that uniquely identifies each product, like <code>product_id</code>.</li></ul><ul id="7d64ff1c-5460-4d61-8ddf-fc11a382fd94" class="bulleted-list"><li style="list-style-type:disc">Since the problem asks for a count, there&#x27;s no need for additional columns in the <code>SELECT</code> statement unless I had specific criteria to filter or categorize the results.<ul id="1e99507e-d1d5-416e-b170-fa9003a3bb3b" class="bulleted-list"><li style="list-style-type:circle"><strong>Using COUNT</strong>: By using <code>COUNT(product_id)</code>, I am ensuring that I’m not counting any NULL values or string data type that would return NULL. <code>product_id </code>is a numeric data type. </li></ul><ul id="6cde6df1-387c-4cc2-bd5d-b58b1987c4d1" class="bulleted-list"><li style="list-style-type:circle"><strong>Avoiding COUNT(products)</strong>: Using <code>COUNT(products)</code> could lead to incorrect results if <code>products</code> is a string or other non-numeric type that could have NULL values. I want to count actual entries rather than potentially counting the column itself, which could yield misleading information.</li></ul></li></ul></div></p><p id="146c4f4e-6826-80e2-abbf-f1ff75fa1b42" class="">
</p><p id="146c4f4e-6826-8007-9aac-f6e6a27fb7c4" class=""><strong>B. Query Code:</strong></p><p id="146c4f4e-6826-806f-8105-d6b3c985411a" class=""><div class="indented"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6313349f-e555-454a-93f2-b9d353cd9b70" class="code"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- COUNT BASIC QUERY
SELECT
 COUNT(product_id) AS Total_products
  from dataset.table_products;

</code></pre></div></p><p id="146c4f4e-6826-804a-b6ff-c3c48bed5c6e" class="">
</p><p id="146c4f4e-6826-809f-98eb-f21f08a9aae1" class=""><strong>C. Explanation of the Result:</strong></p><p id="146c4f4e-6826-800d-95da-c6bf24c7a9b2" class="">The result will be a single column with the number of products in the table. If there are 20 products in the table the results would be:</p><p id="146c4f4e-6826-802b-876e-cfb25ca38ad9" class="">Total_products</p><p id="146c4f4e-6826-80ce-99a1-e7a045f2d2e2" class="">20</p></div></details></div><div id="146c4f4e-6826-8023-ab54-d157de343801" style="width:4.166666666666666%" class="column"><p id="146c4f4e-6826-8001-a7ed-f161cbaf26bb" class="">
</p></div><div id="146c4f4e-6826-8045-baa8-fb8043f8a497" style="width:100%" class="column"><p id="146c4f4e-6826-801e-8414-fac48739697e" class="">
</p></div></div><div id="121c4f4e-6826-8003-b2e6-f983238040a0" class="column-list"><div id="121c4f4e-6826-8028-b958-eecc2fcf8cdc" style="width:356534970500164200%" class="column"><p id="139c4f4e-6826-805b-a973-f015b5f8d09a" class="">
</p></div><div id="121c4f4e-6826-80a1-8341-d9624366290a" style="width:18764998447377064%" class="column"><p id="121c4f4e-6826-80ca-86bc-d59ad4a1d7b2" class="">
</p></div></div><p id="121c4f4e-6826-80e2-861e-fe43a82e9b86" class="">
</p></div><div id="121c4f4e-6826-80a1-8341-d9624366290a" style="width:18764998447377064%" class="column"><p id="121c4f4e-6826-80ca-86bc-d59ad4a1d7b2" class="">
</p></div></div><p id="121c4f4e-6826-80e2-861e-fe43a82e9b86" class="">
</p></div></article>
</p></div><div id="115c4f4e-6826-8023-8aa0-f0664eadb9a2" style="width:100%" class="column"><p id="115c4f4e-6826-80fe-867a-dfe84580c409" class="">	
</p></div><div id="115c4f4e-6826-8023-8aa0-f0664eadb9a2" style="width:100%" class="column"><p id="115c4f4e-6826-80fe-867a-dfe84580c409" class="">
</p></div></div><div id="115c4f4e-6826-8046-9fc7-ed2bbc904357" class="column-list"><div id="115c4f4e-6826-80e3-8cd7-d3cf535e2329" style="width:3.125%" class="column"><p id="115c4f4e-6826-80be-9536-d0be464c36ef" class="">
</p></div><div id="115c4f4e-6826-8099-a2b7-f1f5bda3ea71" style="width:100%" class="column"><hr id="115c4f4e-6826-805b-a37e-c89c44332112"/><h3 id="115c4f4e-6826-8023-a094-e1a5ee0ee7c9" class=""><strong>Contact Information:</strong></h3><p id="115c4f4e-6826-8030-b2ce-fbe252e122ff" class="">Email: meryemkciftci@gmail.com</p><p id="115c4f4e-6826-808c-b9b1-cbf74fe396f5" class=""><a href="https://www.linkedin.com/in/meryack"target="_blank">LinkedIn: Meryack</a></p><p id="115c4f4e-6826-807e-83d7-d87246ed43ae" class="">
</p><p id="115c4f4e-6826-809d-ae2a-cca4e2bce97a" class="">
</p><p id="115c4f4e-6826-8059-bcbf-fdc6d2669f2b" class="">
</p><p id="115c4f4e-6826-801f-9b27-f1488fee2ef2" class=""><strong>Other:</strong></p><ul id="115c4f4e-6826-807d-829b-fe7436fba44a" class="bulleted-list"><li style="list-style-type:disc"><a href="https://calendly.com/meryemkciftci"target="_blank">Schedule a Meeting</a></li></ul><ul id="115c4f4e-6826-8009-ba29-ebb09f03d709" class="bulleted-list"><li style="list-style-type:disc"><a href="https://docs.google.com/forms/d/e/1FAIpQLSeu9b5yhTAsPYNw7ri8wO1vmbrFLrJ120AA31ChqkBackIbiQ/viewform?pli=1"target="_blank">Send an Inquiry</a></li></ul><p id="115c4f4e-6826-8032-b8c0-e4a57fe1e28d" class="">
</p><p id="115c4f4e-6826-800d-98fc-dd2331909f1f" class=""><strong>© 2024 Meryem Çiftçi. All rights reserved.</strong></p><p id="115c4f4e-6826-809c-9fc2-d2848104786c" class="">Built with Notion and GitHub Pages.</p></div><div id="115c4f4e-6826-80b0-8269-ff7f7a826f77" style="width:75%" class="column"><hr id="115c4f4e-6826-80a3-a3c3-d47f94e2ec91"/><p id="115c4f4e-6826-804e-aca2-f2195d06a1a8" class="">
</p><p id="115c4f4e-6826-8030-8c1d-fdbaed337b75" class=""><strong>Quick Links:</strong></p><ul id="115c4f4e-6826-80f2-a039-cf2326199255" class="bulleted-list"><li style="list-style-type:disc"><a href="https://meryemciftcialy.github.io/analyst-journal/">Home</a></li></ul><ul id="115c4f4e-6826-80f3-b84b-fdf37c1631ae" class="bulleted-list"><li style="list-style-type:disc"><a href="https://meryemciftcialy.github.io/analyst-journal/AboutMe.html">About</a></li></ul><ul id="115c4f4e-6826-80e4-8252-f89d64ee6c1b" class="bulleted-list"><li style="list-style-type:disc"><a href="https://meryemciftcialy.github.io/analyst-journal/">Portfolio</a></li></ul><ul id="115c4f4e-6826-80d2-90c3-e108841c3d3b" class="bulleted-list"><li style="list-style-type:disc"><a href=" https://meryemciftcialy.github.io/analyst-journal/DataVisGall.html">Data Visualization</a></li></ul><ul id="115c4f4e-6826-8095-84c0-d928a0b50f68" class="bulleted-list"><li style="list-style-type:disc"><a href="https://meryemciftcialy.github.io/analyst-journal/">Scenarios and Problem Solving</a></li></ul><p id="115c4f4e-6826-80ea-9b88-c82f1149d76d" class="">
<li style="list-style-type:disc"><a href="https://meryemciftcialy.github.io/analyst-journal/certificates.html">Certification</a></li></ul><p id="115c4f4e-6826-80ea-9b88-c82f1149d76d" class="">	
</p></div><div id="115c4f4e-6826-8006-9ba7-d517755388a5" style="width:75%" class="column"><hr id="115c4f4e-6826-8008-92f1-f0e516272a57"/><p id="115c4f4e-6826-80f2-aced-ed17ca044124" class="">
</p><p id="115c4f4e-6826-80ee-af11-fcdb9bc7a530" class=""><strong>Tools and Technologies:</strong></p><ul id="115c4f4e-6826-8028-89ad-e2cb36995237" class="bulleted-list"><li style="list-style-type:disc"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">SQL</a></strong></li></ul><ul id="115c4f4e-6826-80b2-8997-ca5b2c59f94f" class="bulleted-list"><li style="list-style-type:disc"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">Tableau</a></strong></li></ul><ul id="115c4f4e-6826-801b-9776-dc450b80cc01" class="bulleted-list"><li style="list-style-type:disc"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">Google Sheets</a></strong></li></ul><ul id="115c4f4e-6826-8043-a817-e548fefdd077" class="bulleted-list"><li style="list-style-type:disc"><strong><a href="https://meryemciftcialy.github.io/analyst-journal/">R</a></strong></li></ul><ul id="115c4f4e-6826-80a2-86da-c91c5c6431e5" class="bulleted-list"><li style="list-style-type:disc"><strong><a href="https://github.com/MeryemCiftciAly/analystworkbook.git"target="_blank">GitHub Codes</a></strong></li></ul></div></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span>
